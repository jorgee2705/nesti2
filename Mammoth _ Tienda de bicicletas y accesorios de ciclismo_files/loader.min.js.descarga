(()=>{var Ue=Object.defineProperty,Pe=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var z=(t,e,r)=>e in t?Ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,g=(t,e)=>{for(var r in e||(e={}))Re.call(e,r)&&z(t,r,e[r]);if(q)for(var r of q(e))ke.call(e,r)&&z(t,r,e[r]);return t},Q=(t,e)=>Pe(t,Ce(e));var c=(t,e,r)=>new Promise((n,o)=>{var i=m=>{try{u(r.next(m))}catch(a){o(a)}},s=m=>{try{u(r.throw(m))}catch(a){o(a)}},u=m=>m.done?n(m.value):Promise.resolve(m.value).then(i,s);u((r=r.apply(t,e)).next())});var L=class{constructor(e={}){e=Object.assign({resolveTimeout:null,resolveValue:!0,rejectTimeout:null,rejectValue:!1},e),this._promise=new Promise((s,u)=>{this.resolve=s,this.reject=u}),this.then=this._promise.then.bind(this._promise),this.catch=this._promise.catch.bind(this._promise),this.finally=this._promise.finally.bind(this._promise),this[Symbol.toStringTag]="Promise";let{resolveTimeout:r,resolveValue:n,rejectTimeout:o,rejectValue:i}=e;r&&setTimeout(()=>this.resolve(n),r),o&&setTimeout(()=>this.reject(i),o)}};var T="layer",J="quiz";function G(t){return t.reduce(function(e,r){return e[r]=new L,e},{})}function W(t){return function(e,r){return c(this,null,function*(){if(!t[e])throw new Error(`unknown "${e}" app!`);r(yield t[e])})}}var U="__DF_DEBUG_MODE__",X="true",_=window.sessionStorage;function Z(){_.setItem(U,X)}function ee(){_.removeItem(U)}function P(){return _.getItem(U)===X}function v(t){return _.getItem(t)||window[t]}function S(t,e){_.setItem(t,e)}function h(...t){P()&&console.log("[doofinder]",...t)}var $e=10,je=500;function te(t,e={}){let r=document.querySelector(t);return r?Promise.resolve(r):new Promise((n,o)=>{let i=0,s=null,u=e.interval||je,m=e.times||$e;s=setInterval(function(){i++<m?(r=document.querySelector(t),r&&(clearInterval(s),n(r))):(clearInterval(s),o(`selector '${t}' not found`))},u)})}var re=["Backspace","Delete","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","Tab"];var ne=3,oe="df:trigger:click",Ae="df:trigger:focus",Oe="df:trigger:input",ie="df:trigger:submit",C=class{constructor(e){this._minCaptureLength=ne,this._elementSelector=e,this.__chooseTriggerElement__(e),this._eventBus=null,this._eventsQueue=[],this._events=[["click",this.handleClick.bind(this),!0],["focus",this.handleFocus.bind(this),!0],["input",this.handleInput.bind(this),!1],["submit",this.handleSubmit.bind(this),!0],["keypress",this.handleKeypress.bind(this),!0],["keyup",this.handleKeypress.bind(this),!0],["keydown",this.handleKeypress.bind(this),!0]],this._handleSubmit=!1,this._enabled=!1,this._redirection=null}__chooseTriggerElement__(e){this._element=Array.from(document.querySelectorAll(e)).find(r=>r.offsetWidth>0&&r.offsetHeight>0)}updateQuery(e=""){return c(this,null,function*(){let r=yield this.getElement();r instanceof HTMLInputElement&&(r.value=e)})}focus(){return c(this,null,function*(){let e=yield this.getElement();e instanceof HTMLInputElement&&e.focus()})}setCaptureLength(e){this._minCaptureLength=e||ne}getElement(){return c(this,null,function*(){if(!(!this._enabled||!this._elementSelector)){if(!this._element)try{this._element=yield te(this._elementSelector)}catch(e){this._element=void 0}return this._element}})}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==!!e){this._enabled=!!e;let r=document[`${this._enabled?"add":"remove"}EventListener`];this._events.forEach(n=>r(...n))}}get captureSubmit(){return this._handleSubmit}set captureSubmit(e){this._handleSubmit=!!e}get redirection(){return this._redirection}set redirection(e){this._redirection=e}setEventBus(e){this._eventBus=e}flushMessages(){var e;if(this._eventsQueue=[...new Map(this._eventsQueue).entries()],this._eventsQueue.length>0){let r=this._eventsQueue.shift();for(;r&&r.length===2;)h("trigger:emit",r),(e=this._eventBus)==null||e.emit(...r),r=this._eventsQueue.shift()}else document.activeElement===this._element&&this.notify(oe,this.getPayload())}destroy(){this._events.forEach(e=>window.removeEventListener(...e))}shouldHandle(e){let r=this.getElementFromEvent(e);return r?(this._element=r,!0):!1}getPayload(e){let r={source:this._element,originalEvent:e};if(this._element instanceof HTMLInputElement){let n=this._element.value.trim();(n.length>=this._minCaptureLength||(e==null?void 0:e.type)==="keydown"||(e==null?void 0:e.type)==="keyup")&&(r.query=n)}return r}getElementFromEvent(e){if(!e.target||e.target===document||e.target===window)return;let r=e.type==="submit"?"querySelector":"closest",n=e.target[r](this._elementSelector);if(n&&!n.closest("[dfd-hook]"))return n}charLimitReached(e){let r=this.getElementFromEvent(e);return!r||!r.value||e.type!=="keydown"||r.value.length<50||re.includes(e.key)?!1:(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!0)}handleClick(e){this.shouldHandle(e)&&(e.preventDefault(),e.stopImmediatePropagation(),this.notify(oe,this.getPayload(e)))}handleFocus(e){let r=this.getElementFromEvent(e);r&&this.isButtonLike(r)||this.shouldHandle(e)&&(e.stopImmediatePropagation(),this.notify(Ae,this.getPayload(e)))}handleInput(e){this.shouldHandle(e)&&this.notify(Oe,this.getPayload(e))}handleSubmit(e){this._handleSubmit&&this.shouldHandle(e)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.notify(ie,this.getPayload(e)))}handleKeypress(e){this.charLimitReached(e)||e.key==="Enter"&&this.shouldHandle(e)&&(!!this._redirection||this._handleSubmit)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this._redirection?window.location=this._redirection.url:e.type==="keyup"&&this.notify(ie,this.getPayload(e)))}isButtonLike(e){let{tagName:r,role:n}=e;return r==="BUTTON"||n==="button"}notify(e,r){this._eventBus?this._eventBus.emit(e,r):this._eventsQueue.push([e,r]),h("[trigger]",this._eventBus?"[emit]":"[queue]",e,r)}};function se(t){let e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));if(e)return decodeURIComponent(e[1])}var R=Object.freeze({language(t){let e=(t==null?void 0:t.replaceAll("_","-").trim().split("-"))||[];function r(n){return n?`-${n.toUpperCase()}`:""}if(e.length<3){let[n,o]=e;return`${n==null?void 0:n.toLowerCase()}${r(o)}`}else{let[n,o,i]=e;return`${n==null?void 0:n.toLowerCase()}-${o.toUpperCase()}${r(i)}`}},currency(t){return t==null?void 0:t.trim().toUpperCase()}});function k(){return v("__DF_CDN_PREFIX__")}function ae(t,e=!1){let r=v("__DF_LAYER_SERVER__")||`https://${t.toLowerCase()}-layer.doofinder.com`;return e?r.replace(/^http/,"ws"):r}var le=1;function d(t,e,r){r!=null&&(typeof r!="string"||!!r.trim())&&t.push(`${e}=${r}`)}function Ne(t,e){var b;let{installationId:r,hashid:n,language:o,currency:i,zone:s}=t,m=`${ae(s)}/api/${le}/installation/${r}`,a=[];return d(a,"source_url",encodeURIComponent(window.location.href)),d(a,"session_id",Doofinder.Session.getSessionId()),d(a,"session_alive",Doofinder.Session.isLive("layer","quiz")),d(a,"last_used_apps",Doofinder.Session.getLastUsedApps()),d(a,"user_id",Doofinder.Session.getUserId()),d(a,"language",R.language(o||document.documentElement.getAttribute("lang")||"")),d(a,"currency",R.currency(i)||""),d(a,"hashid",n||""),d(a,"ga_client_id",(b=se("_ga"))==null?void 0:b.substring(6)),d(a,"vsn","1.7.2"),d(a,"layer_type",e),d(a,"zone",s),`${m}?${a.join("&")}`}function Ve(t){let e=k()||t.cdn_prefix;e=="https://cdn.doofinder.com/livelayer"&&(e+="/1");let r=t.vsn;return ue(t,o=>({url:`${e}${o}?vsn=${r}`}))}function He(t){if(!t.cdn_fallback_prefix)return Ve(t);let e=t.vsn,r=k()||t.cdn_prefix+"/"+e;return ue(t,o=>{let i=`${r}${o}`;i=r.includes("staging")?`${i}?vsn=${e}`:i;let s=`${t.cdn_fallback_prefix}${o}`;return{url:i,fallbackUrl:s}})}function ue(t,e){return P()&&(t.js=t.js.map(r=>r.replace(/\.min\.js/i,".js"))),t.css=t.css.map(e),t.js=t.js.map(e),t}function ce(t,e){return new Promise(function(r,n){fetch(Ne(t,e),{redirect:"follow"}).then(function(o){o.ok?o.json().then(function(i){r(He(i))}):n(`HTTP ${o.status} error response from server`)}).catch(o=>n(o))})}function $(t){return c(this,null,function*(){let{url:e,fallbackUrl:r}=t;if(!document.querySelector(`script[src="${e}"]`)){let n=document.createElement("script");n.src=e,n.async=1,r&&(n.onerror=()=>$({url:r})),document.head.appendChild(n)}})}function j(t){return c(this,null,function*(){let{url:e,fallbackUrl:r}=t;if(!document.querySelector(`link[rel="stylesheet"][href="${e}"]`)){let n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),r&&(n.onerror=()=>j({url:r})),document.head.appendChild(n)}})}function A(t){return c(this,null,function*(){let e=document.createElement("style");e.appendChild(document.createTextNode((t||"").trim())),document.head.appendChild(e)})}function de(t,e){let r=e.options,{autoload:n,insertion_point:o,is_checkout:i}=e,s="urlHash"in t?!!t.urlHash:!!r.url_hash,u=e.layer_type;return delete t.urlHash,delete r.url_hash,t.hashid&&t.hashid!=r.hashid&&h(`[resources] The script provided this hashid ${t.hashid} but the server resolved ${r.hashid}. The search engine doesn't exist or the settings may be wrong.`),Q(g(g({},t),r),{autoload:n,urlHash:s,layerType:u,insertion_point:o,is_checkout:i})}var me=new Promise((t,e)=>{document.readyState!="loading"?t():document.addEventListener("DOMContentLoaded",()=>{t()})});function he(t){return S("__DF_CDN_PREFIX__",t)}function fe(t){return S("__DF_LAYER_SERVER__",t)}function pe(){try{decodeURIComponent(location.href)}catch(t){throw new Error("invalid UTF-8 on url-encoded query params")}}var O="df-cookies-allowed",N=window.localStorage;function V(){N.setItem(O,"true")}function ge(){N.removeItem(O)}function _e(){return JSON.parse(N.getItem(O)||"false")}var l=[];for(E=0;E<256;++E)l.push((E+256).toString(16).slice(1));var E;function ye(t,e=0){return(l[t[e+0]]+l[t[e+1]]+l[t[e+2]]+l[t[e+3]]+"-"+l[t[e+4]]+l[t[e+5]]+"-"+l[t[e+6]]+l[t[e+7]]+"-"+l[t[e+8]]+l[t[e+9]]+"-"+l[t[e+10]]+l[t[e+11]]+l[t[e+12]]+l[t[e+13]]+l[t[e+14]]+l[t[e+15]]).toLowerCase()}var w,Me=new Uint8Array(16);function H(){if(!w&&(w=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!w))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return w(Me)}var Ke=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),M={randomUUID:Ke};function Be(t,e,r){if(M.randomUUID&&!e&&!t)return M.randomUUID();t=t||{};var n=t.random||(t.rng||H)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var o=0;o<16;++o)e[r+o]=n[o];return e}return ye(n)}var y=Be;var be={canPushState(){return typeof history.pushState!="undefined"},dropLocal(t,e,r){return t.removeItem(this.localKey(e,r))},updateLocal(t,e,r,n,o){let i=this.getLocal(t,e,r),s=this.localKey(e,r),u=i===null?n:o(i);return t.setItem(s,JSON.stringify(u)),u},getLocal(t,e,r){return JSON.parse(t.getItem(this.localKey(e,r)))},updateCurrentState(t){!this.canPushState()||history.replaceState(t(history.state||{}),"",window.location.href)},pushState(t,e,r){if(this.canPushState()){if(r!==window.location.href){if(e.type=="redirect"&&e.scroll){let o=history.state||{};o.scroll=e.scroll,history.replaceState(o,"",window.location.href)}delete e.scroll,history[t+"State"](e,"",r||null);let n=this.getHashTargetEl(window.location.hash);n?n.scrollIntoView():e.type==="redirect"&&window.scroll(0,0)}}else this.redirect(r)},setCookie(t,e){document.cookie=`${t}=${e}`},getCookie(t){return document.cookie.replace(new RegExp(`(?:(?:^|.*;s*)${t}s*=s*([^;]*).*$)|^.*$`),"$1")},redirect(t,e){e&&be.setCookie("__phoenix_flash__",e+"; max-age=60000; path=/"),window.location=t},localKey(t,e){return`${t}-${e}`},getHashTargetEl(t){let e=t.toString().substring(1);if(e!=="")return document.getElementById(e)||document.querySelector(`a[name="${e}"]`)}},K=be;var ve=24*60*60*1e3,Se="df",Ee="random-userid",x="session",B="apps",we="tab-id",xe=window.localStorage,Ie=window.sessionStorage;function I(t,e=xe){return K.getLocal(e,Se,t)}function f(t,e,r=xe){return _e()?K.updateLocal(r,Se,t,e,()=>e):null}function Fe(){return{id:y().replaceAll("-",""),expiry:new Date().getTime()+ve,live:[]}}function D(){let t=I(x);return(!t||Ye(t))&&(t=Fe()),f(x,t)}function Ye({expiry:t}){return t<new Date().getTime()}var p={getUserId(){return I(Ee)||f(Ee,y())},getSessionId(){h("[session][getSessionId()] called!");let t=D();return t?t.id:null},getTabId(){return h("[session][getTabId()] called!"),I(we,Ie)||f(we,y().replaceAll("-",""),Ie)},setLive(t){h("[session][setLive()] called!",t);let e=D();if(e===null)return null;e.live.includes(t)||e.live.push(t),e.expiry=new Date().getTime()+ve,f(x,e),f(B,e.live.join())},removeLive(t){h("[session][removeLive()] called!",t);let e=D();if(e===null)return null;e.live=e.live.filter(r=>r!==t),f(x,e),f(B,e.live.join())},getLastUsedApps(){return I(B)||""},isLive(...t){let e=D();return e===null?!1:t.some(n=>e.live.includes(n))}};function qe(){return{"content-type":"application/json"}}function De(r){return c(this,arguments,function*(t,e={}){return(yield fetch(t,g({method:"GET",cache:"no-cache",mode:"cors",headers:qe()},e))).json()})}var F=class{constructor(e){this.zone=e}add(u,m,a){return c(this,arguments,function*(e,r,{id:n,title:o,price:i},s=1){let b=`${this.url(e)}/cart/${p.getSessionId()||""}`,Te=JSON.stringify({amount:s,id:n,title:o,price:i,index:r});return De(b,{method:"PUT",body:Te})})}remove(e,r,n,o=1){return c(this,null,function*(){return console.warn("Deprecated: remove from cart is no longer supported"),Promise.resolve({status:"registered"})})}clear(e){return c(this,null,function*(){return console.warn("Deprecated: clear cart is no longer supported"),Promise.resolve({status:"registered"})})}checkout(e){return c(this,null,function*(){let r=JSON.stringify({session_id:p.getSessionId(),user_id:p.getUserId(),sources:p.getLastUsedApps().split(",")});return De(`${this.url(e)}/checkout`,{method:"PUT",body:r})})}url(e){return`https://${this.zone}-search.doofinder.com/6/${e}/stats`}};var ze={get Session(){return p},buildCart(t){return new F(t)}},Le=ze;var Y=G([T,J]),Qe=W(Y);document.addEventListener("doofinder.register",t=>{let{name:e,entrypoint:r}=t.detail;Y[e].resolve(r)});var Je={vsn:"1.7.2",getRegistry(t){return Y[t]},load(t,e){pe(),V(),Ge(t,e,"search")},enableDebug:Z,disableDebug:ee,setLayerServerUrl:fe,setCDNServerUrl:he,enableCookies:V,disableCookies:ge};function Ge(t,e,r){ce(t,r).then(n=>{var i;n.css.forEach(j),n.custom_css.forEach(A);let o=(i=n.custom_properties)==null?void 0:i.join(`
`);t=de(t,n),t.trigger=We(t),Qe(T,function(s){me.then(()=>{let u=s.create(t);A(`#${u.mount.id} {
${o||""}
}`),typeof e=="function"&&e(u)})}),n.js.forEach($)}).catch(n=>{console.error("[Doofinder] error retrieving resources:",n)})}function We(t){let{autoload:e,trigger:r}=t,n=new C(r);return n.enabled=!e||e.trigger,n}Object.defineProperty(window,"Doofinder",{value:Le,writable:!1});Object.defineProperty(window,"doofinderLoader",{value:Je,writable:!1});})();
